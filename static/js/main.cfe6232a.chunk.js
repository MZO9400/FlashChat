(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{14:function(e,t,a){e.exports={root:"UserProfile_root__3NzBH",avatar:"UserProfile_avatar__2xMy0",editIcon:"UserProfile_editIcon__2hw2k",removeIcon:"UserProfile_removeIcon__JOmn1",posts:"UserProfile_posts__3YowZ",postCard:"UserProfile_postCard__YnzQm"}},140:function(e,t,a){e.exports=a(174)},145:function(e,t,a){},15:function(e,t,a){e.exports={root:"Profile_root__331LO",posts:"Profile_posts__2kI1Q",postCard:"Profile_postCard__MCEZP",avatar:"Profile_avatar__1RCtk",avatarPlus:"Profile_avatarPlus__2E7Br",editIcon:"Profile_editIcon__3l0gk",removeIcon:"Profile_removeIcon__3NLoh",inputForm:"Profile_inputForm__3fNxS",inputpadding:"Profile_inputpadding__tnqeC"}},174:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),i=a.n(o),s=(a(145),a(76)),l=a(57),c=a(214),u=a(219),m=a(220),d=a(48),p=a(224),g=a(221),f=a(111),h=a.n(f),E=a(60),v=a.n(E),b=a(217),y=a(114),C=a.n(y),S=a(115),w=a.n(S),I=a(112),O=a.n(I),x=a(113),_=a.n(x),k=a(40),N=a(20),P=a(13),j=a(241),T=a(222),D=a(175),A=a(225),F=a(226),R=a(227),L=a(84),W=a.n(L),U=a(107),G=a.n(U).a.create({baseURL:Boolean(Object({NODE_ENV:"production",PUBLIC_URL:"/FlashChat",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_isDebugging)?"http://localhost:8000":"https://flash-chat.azurewebsites.net"}),z=function(e){e?G.defaults.headers.common.Authorization=e:delete G.defaults.headers.common.Authorization},B=function(e,t,a){return function(n){n({type:"LOGGING_ACTION"}),G.post("/api/users/login",{email:e,password:t}).then((function(e){localStorage.setItem("JWToken",e.data.token),z(e.data.token);var t=W()(e.data.token).id;n({type:"LOGGED_IN",payload:{isAdmin:!1,loggedIn:t}}),a&&a()})).catch((function(e){n({type:"ERROR",payload:{title:e.response.statusText,text:e.response.data.error}})}))}},M=function(e){return G.post("/api/users/getInfo",{uid:e}).then((function(e){return e})).catch((function(e){return console.log(e)}))},q=a(125),V=a(223),H=a(242),J=Object(c.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},list:{width:250,cursor:"pointer"},search:Object(l.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(P.b)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(P.b)(e.palette.common.white,.25)},marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(1),marginRight:e.spacing(2),width:"auto"}),searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},inputRoot:{color:"inherit"},inputInput:Object(l.a)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("sm"),{width:"12ch","&:focus":{width:"20ch"}})}})),K=Object(c.a)((function(e){return{root:{display:"flex","& > * + *":{marginLeft:e.spacing(2)}}}}));function Z(){var e=K();return r.a.createElement("div",{className:e.root},r.a.createElement(b.a,{color:"secondary"}))}var $=Object(N.b)((function(e){return{loggedIn:e.loggedIn,isAdmin:e.isAdmin,loggingAction:e.loggingAction,error:e.error}}),(function(e){return{checkLogStatus:function(t){return e(function(e){return function(t){t({type:"LOGGING_ACTION"});var a=localStorage.getItem("JWToken");if(a){var n=W()(a);if(n.exp>=Date.now()/1e3)return z(a),e&&e(),t({type:"LOGGED_IN",payload:{isAdmin:!1,loggedIn:n.id}})}t({type:"LOGGED_OUT"})}}(t))},logOut:function(){return e((function(e){localStorage.removeItem("JWToken"),z(!1),e({type:"LOGGED_OUT"})}))},resetError:function(){return e((function(e){return e({type:"RESET"})}))}}}))(Object(k.f)((function(e){r.a.useEffect((function(){e.checkLogStatus((function(){return e.history.push("/login"===e.redirect?"/":e.redirect)}))}),[]);var t,a=r.a.useState(!1),n=Object(s.a)(a,2),o=n[0],i=n[1],l=r.a.useState(""),c=Object(s.a)(l,2),f=c[0],E=c[1];switch(e.location.pathname){case"/login":t="Sign in";break;case"/profile":t=e.loggedIn;break;case"/u/:uid":t="User";break;case"/search":t="Search";break;case"/":default:t="Home"}var b=J(),y=r.a.useState(!1),S=Object(s.a)(y,2),I=S[0],x=S[1],k=function(){f.length>0&&G.post("/api/users/search",{search:f}).then((function(t){E(""),e.history.push({pathname:"/search",state:t.data})}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:b.root},r.a.createElement(u.a,{position:"static"},r.a.createElement(m.a,null,r.a.createElement(g.a,{edge:"start",className:b.menuButton,color:"inherit","aria-label":"menu",onClick:function(){return x(!0)}},r.a.createElement(h.a,null)),r.a.createElement(d.a,{variant:"h6",className:b.title},t),e.isAdmin?r.a.createElement(O.a,null):null,r.a.createElement("div",{className:b.search},r.a.createElement("div",{className:b.searchIcon,onClick:k},r.a.createElement(_.a,null)),r.a.createElement(H.a,{placeholder:"Search\u2026",classes:{root:b.inputRoot,input:b.inputInput},value:f,onChange:function(e){return E(e.target.value)},inputProps:{"aria-label":"search"},onKeyDown:function(e){return"Enter"===e.key?k():null}})),e.loggingAction?r.a.createElement(Z,null):e.loggedIn?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{style:{display:"flex",cursor:"pointer"},onClick:function(e){return i(e.currentTarget)}},r.a.createElement(v.a,null),r.a.createElement(d.a,{style:{marginLeft:"0.5em"}},e.loggedIn)),r.a.createElement(q.a,{anchorEl:!1===o?null:o,keepMounted:!0,open:o,onClose:function(){return i(!1)}},r.a.createElement(V.a,{onClick:function(){i(!1),e.history.push("/profile")}},"Profile"),r.a.createElement(V.a,{onClick:function(){i(!1),e.logOut()}},"Logout"))):r.a.createElement(p.a,{color:"inherit",onClick:function(){return e.history.push("/login")}},"Sign In")))),r.a.createElement(j.a,{anchor:"left",open:I,onClose:function(){return x(!1)},onOpen:function(){return x(!0)}},r.a.createElement("div",{className:b.list,role:"presentation",onClick:function(){return x(!1)},onKeyDown:function(){return x(!1)}},e.loggingAction?r.a.createElement(Z,null):e.loggedIn?r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,null,r.a.createElement(D.a,{onClick:function(){return e.history.push("/")}},r.a.createElement(A.a,null,r.a.createElement(C.a,null)),r.a.createElement(F.a,null,"Home")),r.a.createElement(D.a,{onClick:function(){return e.history.push("/profile")}},r.a.createElement(A.a,null,r.a.createElement(w.a,null)),r.a.createElement(F.a,null,"Profile"))),r.a.createElement(R.a,null),r.a.createElement(T.a,{onClick:function(){return e.logOut()}},r.a.createElement(D.a,null,r.a.createElement(A.a,null,r.a.createElement(v.a,null)),r.a.createElement(F.a,null,"Sign out")))):r.a.createElement(T.a,{onClick:function(){return e.history.push("/login")}},r.a.createElement(D.a,null,r.a.createElement(A.a,null,r.a.createElement(v.a,null)),r.a.createElement(F.a,null,"Sign in"))))))}))),Q=a(37),Y=a(54),X=a.n(Y),ee=a(71),te=a(29),ae=a(30),ne=a(34),re=a(32),oe=a(243),ie=a(230),se=a(15),le=a.n(se),ce=a(72),ue=a.n(ce),me=a(117),de=a.n(me),pe=a(62),ge=a.n(pe),fe=a(118),he=a.n(fe),Ee=a(74),ve=a.n(Ee),be=a(240),ye=function(e){Object(ne.a)(a,e);var t=Object(re.a)(a);function a(){var e;Object(te.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={name:"",email:"",date:"",currentPass:"",newPass:"",editing:!1,comments:[],username:"",avatar:{image:"",mimetype:""}},e.componentDidMount=Object(ee.a)(X.a.mark((function t(){var a,n;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M(e.props.uid);case 2:a=t.sent,n=a.data,e.setState({name:n.name,email:n.email,date:n.date,username:n._id}),G.post("/api/comments/getAll",{userID:e.props.uid}).then((function(t){return e.setState({comments:t.data?t.data:[]})})),G.post("/api/users/image",{uid:e.props.uid}).then((function(t){return e.setState({avatar:t.data})}));case 7:case"end":return t.stop()}}),t)}))),e.changeName=function(t){e.setState({name:t})},e.changeEmail=function(t){e.setState({email:t})},e.changeCurrPass=function(t){e.setState({currentPass:t})},e.changePass=function(t){e.setState({newPass:t})},e.updateProfile=function(){var t={email:e.state.email,username:e.state.username,name:e.state.name,currentPass:e.state.currentPass};e.state.newPass&&(t.newPass=e.state.newPass),G.post("/api/users/setInfo",t).then((function(t){200===t.status&&e.props.history.push("/")})).catch((function(t){return e.props.setError({title:t.response.statusText,text:t.response.data.error})}))},e.toggleVisibility=function(t){G.post("/api/comments/toggleVisibility",{_id:t}).then((function(a){if(200===a.status){for(var n=Object(Q.a)(e.state.comments),r=0;r<n.length;r++)if(n[r]._id===t){n[r].hidden=!n[r].hidden;break}e.setState({comments:n})}})).catch((function(t){return e.props.setError({title:t.response.statusText,text:t.response.data.error})}))},e.deleteComment=function(t){G.post("/api/comments/delete",{_id:t}).then((function(a){if(200===a.status){console.log(a);var n=Object(Q.a)(e.state.comments).filter((function(e){return e._id!==t}));e.setState({comments:n})}})).catch((function(t){return e.props.setError({title:t.response.statusText,text:t.response.data.error})}))},e.updateAvatar=function(t){if(t.target.files&&t.target.files[0]){var a=new FormData,n=new FileReader,r=t.target.files[0];n.onloadend=function(){e.setState({avatar:n.result}),a.append("image",r);G.put("/api/users/image",a,{headers:{"content-type":"multipart/form-data"}}).catch((function(t){return e.props.setError({title:t.response.statusText,text:t.response.data.error})}))},n.readAsDataURL(r)}},e}return Object(ae.a)(a,[{key:"render",value:function(){var e=this,t=r.a.createElement(r.a.Fragment,null,r.a.createElement(ue.a,{className:le.a.editIcon,onClick:function(){return e.setState({editing:!0})}}),r.a.createElement(oe.a,{className:le.a.avatar,src:"data:".concat(this.state.avatar.mimetype,";base64,").concat(this.state.avatar.image)},this.state.name&&this.state.name[0].toUpperCase()),r.a.createElement(d.a,null,this.state.name),r.a.createElement(d.a,null,this.state.email),r.a.createElement(d.a,{onClick:function(){return e.props.history.push("/u/".concat(e.state.username))},style:{cursor:"pointer"},color:"textSecondary"},this.state.username),r.a.createElement(d.a,null,new Date(this.state.date).toLocaleString()));return this.state.editing&&(t=r.a.createElement(r.a.Fragment,null,r.a.createElement(de.a,{className:le.a.editIcon,onClick:this.updateProfile}),r.a.createElement("input",{accept:"image/*",onChange:this.updateAvatar,id:"avatarselect",style:{display:"none"},type:"file"}),r.a.createElement("label",{htmlFor:"avatarselect"},r.a.createElement(oe.a,{className:le.a.avatar,src:this.state.avatar},r.a.createElement(ge.a,{className:le.a.avatarPlus}))),r.a.createElement("form",{className:le.a.inputForm},r.a.createElement("div",{className:le.a.inputpadding},r.a.createElement(be.a,{type:"name",value:this.state.name,onChange:function(t){return e.changeName(t.target.value)},label:"Name",autoComplete:"name"})),r.a.createElement("div",{className:le.a.inputpadding},r.a.createElement(be.a,{type:"email",value:this.state.email,onChange:function(t){return e.changeEmail(t.target.value)},label:"Email",autoComplete:"email"})),r.a.createElement("div",{className:le.a.inputpadding},r.a.createElement(be.a,{type:"password",value:this.state.currentPass,onChange:function(t){return e.changeCurrPass(t.target.value)},label:"Current Password",autoComplete:"password",required:!0})),r.a.createElement("div",{className:le.a.inputpadding},r.a.createElement(be.a,{type:"password",value:this.state.newPass,onChange:function(t){return e.changePass(t.target.value)},label:"New Password",autoComplete:"new-password"}))))),r.a.createElement(r.a.Fragment,null,r.a.createElement(ie.a,{className:le.a.root},t),this.state.comments.length>0&&r.a.createElement(ie.a,{className:le.a.posts},this.state.comments.map((function(t,a){return r.a.createElement(ie.a,{className:le.a.postCard,key:a},t.hidden?r.a.createElement(ge.a,{className:le.a.editIcon,onClick:function(){return e.toggleVisibility(t._id)}}):r.a.createElement(he.a,{className:le.a.editIcon,onClick:function(){return e.toggleVisibility(t._id)}}),r.a.createElement(ve.a,{className:[le.a.editIcon,le.a.removeIcon].join(" "),onClick:function(){return e.deleteComment(t._id)}}),r.a.createElement(d.a,{variant:"body1",color:"textSecondary",style:{cursor:"pointer"},onClick:function(){return e.props.history.push("/u/".concat(t.fromID))}},t.name),r.a.createElement(d.a,{style:{fontSize:"0.5rem"}},new Date(t.date).toLocaleString()),r.a.createElement(d.a,{variant:"h6",style:{fontWeight:"bold"}},t.title),r.a.createElement(d.a,{variant:"body1"},t.comment),t.edited&&r.a.createElement(d.a,{variant:"body2"},"Edited at ".concat(new Date(t.editedTime).toLocaleString())))}))))}}]),a}(r.a.Component),Ce=Object(k.f)(Object(N.b)((function(e){return{uid:e.loggedIn}}),(function(e){return{setError:function(t){return e({type:"ERROR",payload:t})}}}))(ye)),Se=a(232),we=a(234),Ie=a(233),Oe=a(87),xe=a.n(Oe),_e=a(231),ke=a(229),Ne=a(228),Pe=Object(c.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}));function je(e){var t=Pe();return r.a.createElement(_e.a,{component:"main",maxWidth:"xs"},r.a.createElement(Se.a,null),r.a.createElement("div",{className:t.paper},r.a.createElement(oe.a,{className:t.avatar},r.a.createElement(xe.a,null)),r.a.createElement(d.a,{component:"h1",variant:"h5"},"Sign up"),r.a.createElement("form",{className:t.form,autoComplete:"on"},r.a.createElement(Ie.a,{container:!0,spacing:2},r.a.createElement(Ie.a,{item:!0,xs:12},r.a.createElement(be.a,{autoComplete:"name",name:"Name",variant:"outlined",required:!0,fullWidth:!0,id:"Name",label:"Name",autoFocus:!0,value:e.name.val,onChange:function(t){return e.name.fn(t)}})),r.a.createElement(Ie.a,{item:!0,xs:12},r.a.createElement(be.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",value:e.email.val,onChange:function(t){return e.email.fn(t)}})),r.a.createElement(Ie.a,{item:!0,xs:12},r.a.createElement(be.a,{variant:"outlined",required:!0,fullWidth:!0,id:"username",label:"User name",name:"username",autoComplete:"username",value:e.username.val,onChange:function(t){return e.username.fn(t)}})),r.a.createElement(Ie.a,{item:!0,xs:12},r.a.createElement(Ne.a,{fullWidth:!0},r.a.createElement(be.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:e.pass.val,onChange:function(t){return e.pass.fn(t)}}),r.a.createElement(ke.a,null,"Length: 4-16 characters"),r.a.createElement(ke.a,null,"Must have at least one number"))),r.a.createElement(Ie.a,{item:!0,xs:12})),r.a.createElement(p.a,{fullWidth:!0,variant:"contained",color:"primary",className:t.submit,onClick:function(){return e.submit()},disabled:!e.validity},"Sign Up"),r.a.createElement(Ie.a,{container:!0,justify:"flex-end"},r.a.createElement(Ie.a,{item:!0},r.a.createElement(we.a,{onClick:function(){return e.switchSignState()},variant:"body2",style:{cursor:"pointer"}},"Already have an account? Sign in"))))))}var Te=Object(c.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function De(e){var t=Te();return r.a.createElement(_e.a,{component:"main",maxWidth:"xs"},r.a.createElement(Se.a,null),r.a.createElement("div",{className:t.paper},r.a.createElement(oe.a,{className:t.avatar},r.a.createElement(xe.a,null)),r.a.createElement(d.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement("form",{className:t.form,noValidate:!0},r.a.createElement(be.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:e.email.val,onChange:function(t){return e.email.fn(t)}}),r.a.createElement(be.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:e.pass.val,onChange:function(t){return e.pass.fn(t)}}),r.a.createElement(p.a,{fullWidth:!0,variant:"contained",color:"primary",className:t.submit,onClick:function(){return e.submit()},disabled:!e.validity},"Sign In"),r.a.createElement(Ie.a,{container:!0},r.a.createElement(Ie.a,{item:!0},r.a.createElement(we.a,{onClick:function(){return e.switchSignState()},style:{cursor:"pointer"},variant:"body2"},"Don't have an account? Sign Up"))))))}var Ae=function(e){Object(ne.a)(a,e);var t=Object(re.a)(a);function a(){var e;Object(te.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={signIn:!0,name:"",pass:"",email:"",username:""},e.validateSignIn=function(){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/g.test(e.state.email)&&/^(?=.*\d).{4,16}$/.test(e.state.pass)},e.validateSignUp=function(){return e.state.name.length&&e.validateSignIn()&&/^[a-z0-9_]{3,16}$/gim.test(e.state.username)},e.updateEmail=function(t){e.setState({email:t.target.value})},e.updatePass=function(t){e.setState({pass:t.target.value})},e.updateName=function(t){e.setState({name:t.target.value})},e.updateUsername=function(t){e.setState({username:t.target.value})},e.switchSignState=function(){e.setState((function(e){return{signIn:!e.signIn}}))},e.redirect=function(){var t=e.props.location.data.from.pathname;"/login"===t&&(t="/"),e.props.history.push(t)},e.submit=function(){e.state.signIn?e.props.signInEmail(e.state.email,e.state.pass,e.redirect):e.props.signUpEmail(e.state.email,e.state.pass,e.state.name,e.state.username,e.redirect)},e}return Object(ae.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.state.signIn?r.a.createElement(De,{switchSignState:this.switchSignState,pass:{fn:this.updatePass,val:this.state.pass},email:{fn:this.updateEmail,val:this.state.email},submit:this.submit,validity:this.validateSignIn()}):r.a.createElement(je,{switchSignState:this.switchSignState,pass:{fn:this.updatePass,val:this.state.pass},email:{fn:this.updateEmail,val:this.state.email},name:{fn:this.updateName,val:this.state.name},username:{fn:this.updateUsername,val:this.state.username},submit:this.submit,validity:this.validateSignUp()}))}}]),a}(r.a.Component),Fe=Object(N.b)((function(e){return{loggedIn:e.loggedIn}}),(function(e){return{signInEmail:function(t,a,n){return e(B(t,a,n))},signUpEmail:function(t,a,n,r,o){return e(function(e,t,a,n,r){return function(o){G.post("/api/users/register",{email:e,name:a,password:t,user:n}).then((function(){return o(B(e,t,r))})).catch((function(e){return o({type:"ERROR",payload:{title:e.response.statusText,text:e.response.data.error}})}))}}(t,a,n,r,o))}}}))(Ae),Re=a(14),Le=a.n(Re),We=a(119),Ue=a.n(We),Ge=function(e){Object(ne.a)(a,e);var t=Object(re.a)(a);function a(){var e;Object(te.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={posts:[],fetchSize:20,page:0},e.componentDidMount=function(){window.addEventListener("scroll",e.onScroll,!1),e.fetchNextPosts()},e.componentWillUnmount=function(){window.removeEventListener("scroll",e.onScroll,!1)},e.fetchNextPosts=function(){G.post("/api/users/populateWall",{limit:e.state.fetchSize,page:e.state.page}).then((function(t){return e.setState({posts:[].concat(Object(Q.a)(e.state.posts),Object(Q.a)(t.data.posts)),page:e.state.page+1})})).catch((function(t){return e.props.setError({title:"Error",text:t.response.data.error})}))},e.onScroll=function(){e.hasReachedBottom()&&e.fetchNextPosts()},e.hasReachedBottom=function(){return window.innerHeight+document.documentElement.scrollTop===document.scrollingElement.scrollHeight},e}return Object(ae.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(_e.a,{maxWidth:"md",onScroll:this.onScroll},this.state.posts.length>0&&r.a.createElement(ie.a,{className:Le.a.posts},this.state.posts.map((function(t,a){return r.a.createElement(ie.a,{className:Le.a.postCard,key:a},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(d.a,{variant:"body1",color:"textSecondary",style:{cursor:"pointer"},onClick:function(){return e.props.history.push("/u/".concat(t.fromID))}},t.fromName),t.fromID!==t.toID&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Ue.a,null),r.a.createElement(d.a,{variant:"body1",color:"textSecondary",style:{cursor:"pointer"},onClick:function(){return e.props.history.push("/u/".concat(t.toID))}},t.toName))),r.a.createElement(d.a,{style:{fontSize:"0.5rem"}},new Date(t.date).toLocaleString()),r.a.createElement(d.a,{variant:"h6",style:{fontWeight:"bold"}},t.title),r.a.createElement(d.a,{variant:"body1"},t.comment),t.edited&&r.a.createElement(d.a,{variant:"body2",style:{fontSize:"0.5rem"}},"Edited at ".concat(new Date(t.editedTime).toLocaleString())))}))))}}]),a}(r.a.Component),ze=Object(N.b)((function(e){return{loggedIn:e.loggedIn}}),(function(e){return{setError:function(t){return e({type:"ERROR",payload:t})}}}))(Object(k.f)(Ge)),Be=Object(k.f)((function(e){return r.a.createElement(_e.a,{maxWidth:"md"},e.location.state.result.map((function(t,a){return r.a.createElement(ie.a,{key:a,onClick:function(){return e.history.push("/u/".concat(t._id))},style:{cursor:"pointer",display:"flex",alignContent:"center",alignItems:"center",padding:"1.5em"}},r.a.createElement(oe.a,{src:t.avatar.error?null:"data:".concat(t.avatar.mimetype,";base64,").concat(t.avatar.image)},t.name[0]),r.a.createElement(d.a,{style:{padding:"1em"}},t.name))})))})),Me=a(235),qe=a(237),Ve=a(238),He=a(236),Je=a(120),Ke=a.n(Je),Ze=a(122),$e=a.n(Ze),Qe=a(121),Ye=a.n(Qe),Xe=a(123),et=a.n(Xe),tt=function(e){Object(ne.a)(a,e);var t=Object(re.a)(a);function a(){var e;Object(te.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={id:"",newPostTitle:"",newPostText:"",commentEditTitle:"",commentEditText:"",editing:!1,isFriend:"none",comments:[],avatar:{image:"",mimetype:""}},e.componentDidUpdate=function(t){e.props.match.params.id!==e.state.id&&e.componentDidMount(),e.props.loggedIn!==t.loggedIn&&""!==e.props.loggedIn&&G.post("/api/users/getFriendshipStatus",{id:e.state.id}).then((function(t){return e.setState({isFriend:t.data.friendshipStatus})})).catch((function(t){e.props.setError({title:"Error",text:t.response.data.error})}))},e.componentDidMount=Object(ee.a)(X.a.mark((function t(){var a;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.props.match.params.id,e.setState({id:a}),G.post("/api/users/getInfoPub",{uid:a}).then((function(t){t.data?e.setState({id:t.data._id,name:t.data.name}):e.props.setError({title:"Error",text:"User not found"})})).catch((function(t){e.props.setError({title:"Error",text:t.response.data.error})})),G.post("/api/comments/getPublic",{id:a}).then((function(t){e.setState({comments:t.data?t.data:[]})})).catch((function(t){e.props.setError({title:"Error",text:t.response.data.error})})),G.post("/api/users/image",{uid:a}).then((function(t){return e.setState({avatar:t.data})}));case 5:case"end":return t.stop()}}),t)}))),e.addPost=function(){var t={comment:e.state.newPostText,userID:e.state.id};e.state.newPostTitle.length&&(t.title=e.state.newPostTitle),G.post("/api/comments/postNew",t).then((function(){e.setState({newPostTitle:"",newPostText:""})})).catch((function(t){return e.props.setError({title:"Error",text:t.response.data.error})}))},e.isValid=function(){return e.state.newPostText.length>0},e.deleteComment=function(t){G.post("/api/comments/delete",{_id:t}).then((function(a){if(200===a.status){console.log(a);var n=Object(Q.a)(e.state.comments).filter((function(e){return e._id!==t}));e.setState({comments:n})}})).catch((function(t){return e.props.setError({title:t.response.statusText,text:t.response.data.error})}))},e.toggleFriend=function(){e.props.loggedIn||e.props.history.push("/login"),G.post("/api/users/toggleFriend",{_id:e.state.id}).then((function(){"none"===e.state.isFriend?e.setState({isFriend:"pending"}):e.setState({isFriend:"none"})})).catch((function(t){return e.props.setError({title:"Error",text:t.response.data.error})}))},e.chatWith=function(e){G.post("/api/chats/getChatID",{id:e})},e}return Object(ae.a)(a,[{key:"render",value:function(){var e=this,t=r.a.createElement(Me.a,{open:this.state.editing,onClose:function(){return e.setState({editing:!1})}},r.a.createElement(He.a,null,"Editing Comment"),r.a.createElement(qe.a,null,r.a.createElement("form",null,r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement(be.a,{value:this.state.commentEditTitle,placeholder:"Change title",onChange:function(t){return e.setState({commentEditTitle:t.target.value})}}),r.a.createElement(be.a,{value:this.state.commentEditText,placeholder:"Change text",onChange:function(t){return e.setState({commentEditText:t.target.value})}})))),r.a.createElement(Ve.a,null,r.a.createElement(p.a,{onClick:function(){e.setState({editing:!1,commentEditTitle:"",commentEditText:""})}},"Cancel"),r.a.createElement(p.a,{onClick:function(){G.post("/api/comments/edit",{_id:e.state.editing,title:e.state.commentEditTitle,comment:e.state.commentEditText}).then((function(){var t=Object(Q.a)(e.state.comments).filter((function(t){return t._id!==e.state.editing}));e.setState({editing:!1,commentEditTitle:"",commentEditText:"",comments:t})})).catch((function(t){return e.props.setError({title:"Error",text:t.response.data.error})}))}},"Save Changes")));return r.a.createElement(_e.a,{maxWidth:"md"},t,r.a.createElement(ie.a,{className:Le.a.root},r.a.createElement(oe.a,{className:Le.a.avatar,src:"data:".concat(this.state.avatar.mimetype,";base64,").concat(this.state.avatar.image)},this.state.name&&this.state.name[0].toUpperCase()),this.state.id!==this.props.loggedIn?"none"===this.state.isFriend?r.a.createElement(Ke.a,{className:Le.a.editIcon,onClick:this.toggleFriend}):"pending"===this.state.isFriend?r.a.createElement(Ye.a,{className:Le.a.editIcon,onClick:this.toggleFriend}):r.a.createElement(r.a.Fragment,null,r.a.createElement($e.a,{className:Le.a.editIcon,onClick:this.toggleFriend}),r.a.createElement(et.a,{className:[Le.a.editIcon,Le.a.removeIcon].join(" "),onClick:function(){return e.chatWith(e.state.id)}})):null,r.a.createElement(d.a,{color:"textSecondary"},this.state.id),this.state.name&&r.a.createElement(d.a,null,this.state.name)),r.a.createElement(ie.a,{className:Le.a.root},this.isValid()&&r.a.createElement(ge.a,{className:Le.a.editIcon,onClick:this.addPost}),r.a.createElement(d.a,null,"New Post"),r.a.createElement("form",{style:{marginTop:"2em"}},r.a.createElement(be.a,{placeholder:"Give your post a title",value:this.state.newPostTitle,onChange:function(t){return e.setState({newPostTitle:t.target.value})},style:{marginBottom:"1rem"}}),r.a.createElement(be.a,{multiline:!0,placeholder:"Write something.",maxrows:"8",value:this.state.newPostText,onChange:function(t){return e.setState({newPostText:t.target.value})},fullWidth:!0}))),this.state.comments.length>0&&r.a.createElement(ie.a,{className:Le.a.posts},this.state.comments.map((function(t,a){return r.a.createElement(ie.a,{className:Le.a.postCard,key:a},t.fromID===e.props.loggedIn&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ue.a,{className:Le.a.editIcon,onClick:function(){e.setState({editing:t._id,commentEditTitle:t.title,commentEditText:t.comment})}}),r.a.createElement(ve.a,{className:[Le.a.editIcon,Le.a.removeIcon].join(" "),onClick:function(){return e.deleteComment(t._id)}})),r.a.createElement(d.a,{variant:"body1",color:"textSecondary",style:{cursor:"pointer"},onClick:function(){return e.props.history.push("/u/".concat(t.fromID))}},t.name),r.a.createElement(d.a,{style:{fontSize:"0.5rem"}},new Date(t.date).toLocaleString()),r.a.createElement(d.a,{variant:"h6",style:{fontWeight:"bold"}},t.title),r.a.createElement(d.a,{variant:"body1"},t.comment),t.edited&&r.a.createElement(d.a,{variant:"body2",style:{fontSize:"0.5rem"}},"Edited at ".concat(new Date(t.editedTime).toLocaleString())))}))))}}]),a}(r.a.Component),at=Object(k.f)(Object(N.b)((function(e){return{loggedIn:e.loggedIn}}),(function(e){return{setError:function(t){return e({type:"ERROR",payload:t})}}}))(tt)),nt=a(42),rt=a(58),ot=a(28),it={loggedIn:"",isAdmin:!1,loggingAction:!1,error:null},st=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGGING_ACTION":return Object(ot.a)(Object(ot.a)({},e),{},{loggingAction:!0});case"LOGGED_IN":return Object(ot.a)(Object(ot.a)({},e),{},{loggingAction:!1,loggedIn:t.payload.loggedIn,isAdmin:t.payload.isAdmin});case"LOGGED_OUT":return Object(ot.a)(Object(ot.a)({},e),{},{loggedIn:"",loggingAction:!1,isAdmin:!1});case"ERROR":return Object(ot.a)(Object(ot.a)({},e),{},{error:{title:t.payload.title,text:t.payload.text}});case"RESET":return Object(ot.a)(Object(ot.a)({},e),{},{error:null});default:return e}},lt=a(124),ct=Object(rt.c)(st,Object(rt.a)(lt.a));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ut=a(239),mt=function(e){return r.a.createElement("div",null,r.a.createElement(Me.a,{open:e.open,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(He.a,{id:"alert-dialog-title"},e.title),r.a.createElement(qe.a,null,r.a.createElement(ut.a,{id:"alert-dialog-description"},e.text)),r.a.createElement(Ve.a,null,r.a.createElement(p.a,{onClick:e.accept,color:"primary",autoFocus:!0},e.buttonText?e.buttonText:"Close"))))},dt=function(e){Object(ne.a)(a,e);var t=Object(re.a)(a);function a(){return Object(te.a)(this,a),t.apply(this,arguments)}return Object(ae.a)(a,[{key:"render",value:function(){var e,t,a=this;return this.props.error&&(e=this.props.error.title,t=this.props.error.text),r.a.createElement(mt,{open:null!==this.props.error,title:e,text:t,accept:function(){return a.props.resetError()}})}}]),a}(r.a.Component),pt=Object(N.b)((function(e){return{error:e.error}}),(function(e){return{resetError:function(){return e((function(e){return e({type:"RESET"})}))}}}))(dt);a(171).config();var gt=Object(N.b)((function(e){return{loggedIn:e.loggedIn}}))(Object(k.f)((function(e){var t=r.a.createElement(r.a.Fragment,null,r.a.createElement(k.b,{exact:!0,path:"/",component:ze}),r.a.createElement(k.b,{exact:!0,path:"/profile",component:Ce})),a=r.a.createElement(r.a.Fragment,null,r.a.createElement(k.b,{exact:!0,path:"/login",component:Fe}),r.a.createElement(k.a,{to:{pathname:"/login",data:{from:e.location}}})),n=r.a.createElement(r.a.Fragment,null,r.a.createElement(k.b,{path:"/search",component:Be}),r.a.createElement(k.b,{path:"/u/:id",component:at}));return r.a.createElement(r.a.Fragment,null,r.a.createElement($,{redirect:e.location}),e.loggedIn?t:a,n)})));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(N.a,{store:ct},r.a.createElement(nt.a,{basename:"/FlashChat"},r.a.createElement(Se.a,null),r.a.createElement(pt,null),r.a.createElement(gt,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[140,1,2]]]);
//# sourceMappingURL=main.cfe6232a.chunk.js.map